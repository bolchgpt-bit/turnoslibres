{% set msg_text = message_text if message_text is defined else None %}
{% set msg_cat = message_category if message_category is defined else None %}

<div class="p-4">
  <h3 class="text-lg font-semibold text-gray-900 mb-1">Canchas del complejo</h3>
  <p class="text-gray-600 mb-3">{{ complex.name }} (ID {{ complex.id }})</p>

  {% if msg_text %}
    <div class="mb-3 {{ 'text-green-700 bg-green-100 border-green-200' if msg_cat=='success' else 'text-red-700 bg-red-100 border-red-200' }} border rounded px-3 py-2">
      {{ msg_text }}
    </div>
  {% endif %}

  <div class="bg-white rounded-lg border border-gray-200 p-4 mb-4">
    <h4 class="text-md font-semibold text-gray-900 mb-3">Crear nueva cancha</h4>
    <form
      hx-post="{{ url_for('admin.fields_create') }}"
      hx-target="#link-form-content"
      hx-swap="innerHTML"
      method="post"
    >
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
      <input type="hidden" name="complex_id" value="{{ complex.id }}" />

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="form-label">Nombre</label>
          <input name="name" class="form-input" required />
        </div>
        <div>
          <label class="form-label">Deporte</label>
          <input name="sport" class="form-input" placeholder="futbol, padel, tenis" required />
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-3">
        <div>
          <label class="form-label">Jugadores por equipo</label>
          <input name="team_size" class="form-input" type="number" min="1" max="50" placeholder="5 para f-5, 7 para f-7" />
        </div>
        <div>
          <label class="form-label">Superficie</label>
          <input name="surface" class="form-input" placeholder="sintético, cemento, pasto" />
        </div>
        <div class="flex items-end">
          <label class="inline-flex items-center">
            <input type="checkbox" name="is_active" value="y" class="mr-2" checked /> Activa
          </label>
        </div>
      </div>

      <div class="mt-4">
        <button type="submit" class="btn-primary">Crear cancha</button>
      </div>
    </form>
  </div>

  <div class="overflow-x-auto">
    <table class="min-w-full divide-y divide-gray-200">
      <thead class="bg-gray-50">
        <tr>
          <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">ID</th>
          <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Nombre</th>
          <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Deporte</th>
          <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Equipo</th>
          <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Superficie</th>
          <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Activa</th>
        </tr>
      </thead>
      <tbody class="bg-white divide-y divide-gray-200">
        {% for f in fields %}
        <tr>
          <td class="px-4 py-2 whitespace-nowrap text-sm text-gray-900">{{ f.id }}</td>
          <td class="px-4 py-2 whitespace-nowrap text-sm text-gray-900">{{ f.name }}</td>
          <td class="px-4 py-2 whitespace-nowrap text-sm text-gray-900">{{ f.display_sport or f.sport }}</td>
          <td class="px-4 py-2 whitespace-nowrap text-sm text-gray-900">{{ f.team_size or '-' }}</td>
          <td class="px-4 py-2 whitespace-nowrap text-sm text-gray-900">{{ f.surface or '-' }}</td>
          <td class="px-4 py-2 whitespace-nowrap text-sm text-gray-900">{{ 'Sí' if f.is_active else 'No' }}</td>
        </tr>
        {% endfor %}
        {% if fields|length == 0 %}
        <tr>
          <td colspan="6" class="px-4 py-3 text-sm text-gray-500">Sin canchas registradas aún.</td>
        </tr>
        {% endif %}
      </tbody>
    </table>
  </div>

  <div class="mt-4 flex gap-2">
    <button onclick="hideLinkForm()" class="btn-secondary">Cerrar</button>
  </div>
</div>

